<template>
  <div
    id="ecgViewerElement"
    style="width: 100%; height: 360px"
    ref="ecgViewerElement"
  ></div>
</template>

<script>
export default {
  name: 'ecgViewer',

  mounted() {
    const CanvasJS = require('@/assets/canvasjs.min.js')

    // reference: https://codepen.io/AlecWang/pen/OJNmXYm

    // Important: https://codepen.io/love_fantasy/pen/BmEvZo

    var xAxisStripLinesArray = []
    var yAxisStripLinesArray = []
    var dps = []
    // var dataPointsArray = [
    //   1835, 1967, 1956, 1952, 1952, 1919, 1886, 1886, 1883, 1883, 1876, 1859,
    //   1859, 1838, 1844, 1844, 1838, 1823, 1823, 1823, 1850, 1850, 1817, 1824,
    //   1824, 1846, 1835, 1835, 1838, 1838, 1853, 1853, 1853, 1853, 1862, 1862,
    //   1858, 1872, 1872, 1876, 1874, 1874, 1883, 1896, 1896, 1911, 1911, 1910,
    //   1913, 1913, 1906, 1935, 1935, 1933, 1934, 1934, 1936, 1944, 1944, 1943,
    //   1948, 1948, 1939, 1957, 1957, 1963, 1954, 1954, 1954, 1954, 1971, 1971,
    //   1971, 1967, 1960, 1960, 1970, 1976, 1976, 1971, 1962, 1962, 1978, 1960,
    //   1960, 1957, 1957, 1972, 1966, 1966, 1966, 1960, 1960, 1955, 1968, 1968,
    //   1970, 1956, 1956, 1971, 1972, 1972, 1959, 1972, 1972, 1991, 1978, 1978,
    //   1967, 1967, 1966, 1979, 1979, 1973, 1968, 1968, 1979, 1977, 1977, 1960,
    //   1970, 1970, 1975, 1964, 1964, 1968, 1968, 1969, 1960, 1960, 1971, 1970,
    //   1970, 1974, 1975, 1975, 1967, 1960, 1960, 1976, 1974, 1974, 1983, 1978,
    //   1978, 1974, 1974, 1985, 1982, 1982, 1974, 1984, 1984, 1983, 1984, 1984,
    //   1992, 1987, 1987, 1987, 1987, 1987, 1992, 1992, 1987, 1996, 1996, 1996,
    //   1992, 1992, 1994, 1992, 1992, 2004, 2001, 2001, 2004, 1998, 1998, 1991,
    //   2005, 2005, 2022, 2022, 2005, 2007, 2007, 2011, 2012, 2012, 2008, 2016,
    //   2016, 2021, 2024, 2024, 2005, 2011, 2011, 2019, 2019, 2014, 2015, 2015,
    //   2014, 1999, 1999, 2011, 2013, 2013, 1999, 2024, 2024, 2008, 1996, 1996,
    //   2027, 2011, 2011, 2010, 2010, 2036, 2023, 2023, 2028, 2045, 2045, 2050,
    //   2051, 2051, 2059, 2054, 2054, 2067, 2056, 2056, 2047, 2066, 2066, 2049,
    //   2049, 2035, 2041, 2041, 2013, 2020, 2020, 2014, 1998, 1998, 1990, 1992,
    //   1992, 1987, 1980, 1980, 1979, 1985, 1985, 1980, 1980, 1981, 1992, 1992,
    //   1974, 1987, 1987, 1977, 1981, 1981, 1983, 1987, 1987, 2013, 2040, 2040,
    //   2083, 2130, 2130, 2183, 2183, 2250, 2325, 2325, 2423, 2527, 2527, 2559,
    //   2559, 2559, 2523, 2368, 2368, 2232, 2096, 2096, 2004, 2004, 1901, 1858,
    //   1858, 1834, 1838, 1838, 1831, 1853, 1853, 1847, 1845, 1845, 1851, 1860,
    //   1860, 1870, 1872, 1872, 1891, 1893, 1893, 1894, 1894, 1901, 1919, 1919,
    //   1917, 1930, 1930, 1947, 1925, 1925, 1943, 1952, 1952, 1947, 1954, 1954,
    //   1951, 1951, 1960, 1962, 1962, 1966, 1978, 1978, 1979, 1973, 1973, 1984,
    //   1978, 1978, 1984, 1991, 1991, 1983, 1983, 1983, 1999, 1992, 1992, 1998,
    //   1998, 1998, 2006, 2006, 1999, 2016, 2016, 2005, 2038, 2038, 2006, 2017,
    //   2017, 2042, 2027, 2027, 2031, 2031, 2051, 2044, 2044, 2043, 2070, 2070,
    //   2062, 2055, 2055, 2065, 2056, 2056, 2070, 2080, 2080, 2068, 2078, 2078,
    //   2077, 2077, 2074, 2087, 2087, 2093, 2102, 2102, 2091, 2102, 2102, 2118,
    //   2114, 2114, 2116, 2128, 2128, 2108, 2108, 2095, 2108, 2108, 2102, 2096,
    //   2096, 2094, 2081, 2081, 2074, 2082, 2082, 2088, 2059, 2059, 2058, 2050,
    //   2050, 2027, 2027, 2014, 2009, 2009, 1991, 1981, 1981, 1951, 1949, 1949,
    //   1932, 1918, 1918, 1923, 1893, 1893, 1885, 1885, 1894, 1882, 1882, 1871,
    //   1890, 1890, 1865, 1868, 1868, 1874, 1876, 1876, 1887, 1884, 1884, 1886,
    //   1888, 1888, 1895, 1902, 1902, 1898, 1898, 1898, 1906, 1906, 1911, 1914,
    //   1914, 1918, 1922, 1922, 1918, 1936, 1936, 1950, 1937, 1937, 1944, 1944,
    //   1955, 1947, 1947, 1951, 1984, 1984, 1950, 1972, 1972, 1974, 1958, 1958,
    //   1982, 1971, 1971, 1983, 1974, 1974, 1967, 1986, 1986, 1979, 1979, 1970,
    //   1986, 1986, 1966, 1955, 1955, 1970, 1976, 1976, 1972, 1968, 1968, 1970,
    //   1969, 1969, 1967, 1967, 1998, 1976, 1976, 1981, 1994, 1994, 1982, 1987,
    //   1987, 1987, 1996, 1996, 1983, 1974, 1974, 1991, 1991, 1982, 1984, 1984,
    //   2004, 1982, 1982, 1983, 2009, 2009, 1995, 1991, 1991, 2001, 2000, 2000,
    //   1991, 1999, 1999, 2002, 1988, 1988, 1999, 1999, 1979, 2006, 2006, 2005,
    //   1983, 1983, 1995, 1986, 1986, 1992, 2010, 2010, 1993, 2000, 2000, 1994,
    //   1994, 1990, 2012, 2012, 1989, 1993, 1993, 1993, 1986, 1986, 1999, 1986,
    //   1986, 2002, 1995, 1995, 1995, 1993, 1993, 2000, 2000, 1996, 1997, 1997,
    //   1995, 1998, 1998, 1983, 1997, 1997, 1998, 1990, 1990, 1993, 1996, 1996,
    //   1982, 1995, 1995, 2003, 2003, 2003, 1996, 1996, 1993, 1989, 1989, 2007,
    //   2008, 2008, 2006, 2004, 2004, 1997, 2000, 2000, 2012, 2007, 2007, 2013,
    //   2013, 2010, 2004, 2004, 2010, 2011, 2011, 2011, 2015, 2015, 2015, 2016,
    //   2016, 2011, 2005, 2005, 2014, 2014, 2008, 1998, 1998, 2021, 2009, 2009,
    //   2007, 2018, 1835, 1967, 1956, 1952, 1952, 1919, 1886, 1886, 1883, 1883,
    //   1876, 1859, 1859, 1838, 1844, 1844, 1838, 1823, 1823, 1823, 1850, 1850,
    //   1817, 1824, 1824, 1846, 1835, 1835, 1838, 1838, 1853, 1853, 1853, 1853,
    //   1862, 1862, 1858, 1872, 1872, 1876, 1874, 1874, 1883, 1896, 1896, 1911,
    //   1911, 1910, 1913, 1913, 1906, 1935, 1935, 1933, 1934, 1934, 1936, 1944,
    //   1944, 1943, 1948, 1948, 1939, 1957, 1957, 1963, 1954, 1954, 1954, 1954,
    //   1971, 1971, 1971, 1967, 1960, 1960, 1970, 1976, 1976, 1971, 1962, 1962,
    //   1978, 1960, 1960, 1957, 1957, 1972, 1966, 1966, 1966, 1960, 1960, 1955,
    //   1968, 1968, 1970, 1956, 1956, 1971, 1972, 1972, 1959, 1972, 1972, 1991,
    //   1978, 1978, 1967, 1967, 1966, 1979, 1979, 1973, 1968, 1968, 1979, 1977,
    //   1977, 1960, 1970, 1970, 1975, 1964, 1964, 1968, 1968, 1969, 1960, 1960,
    //   1971, 1970, 1970, 1974, 1975, 1975, 1967, 1960, 1960, 1976, 1974, 1974,
    //   1983, 1978, 1978, 1974, 1974, 1985, 1982, 1982, 1974, 1984, 1984, 1983,
    //   1984, 1984, 1992, 1987, 1987, 1987, 1987, 1987, 1992, 1992, 1987, 1996,
    //   1996, 1996, 1992, 1992, 1994, 1992, 1992, 2004, 2001, 2001, 2004, 1998,
    //   1998, 1991, 2005, 2005, 2022, 2022, 2005, 2007, 2007, 2011, 2012, 2012,
    //   2008, 2016, 2016, 2021, 2024, 2024, 2005, 2011, 2011, 2019, 2019, 2014,
    //   2015, 2015, 2014, 1999, 1999, 2011, 2013, 2013, 1999, 2024, 2024, 2008,
    //   1996, 1996, 2027, 2011, 2011, 2010, 2010, 2036, 2023, 2023, 2028, 2045,
    //   2045, 2050, 2051, 2051, 2059, 2054, 2054, 2067, 2056, 2056, 2047, 2066,
    //   2066, 2049, 2049, 2035, 2041, 2041, 2013, 2020, 2020, 2014, 1998, 1998,
    //   1990, 1992, 1992, 1987, 1980, 1980, 1979, 1985, 1985, 1980, 1980, 1981,
    //   1992, 1992, 1974, 1987, 1987, 1977, 1981, 1981, 1983, 1987, 1987, 2013,
    //   2040, 2040, 2083, 2130, 2130, 2183, 2183, 2250, 2325, 2325, 2423, 2527,
    //   2527, 2559, 2559, 2559, 2523, 2368, 2368, 2232, 2096, 2096, 2004, 2004,
    //   1901, 1858, 1858, 1834, 1838, 1838, 1831, 1853, 1853, 1847, 1845, 1845,
    //   1851, 1860, 1860, 1870, 1872, 1872, 1891, 1893, 1893, 1894, 1894, 1901,
    //   1919, 1919, 1917, 1930, 1930, 1947, 1925, 1925, 1943, 1952, 1952, 1947,
    //   1954, 1954, 1951, 1951, 1960, 1962, 1962, 1966, 1978, 1978, 1979, 1973,
    //   1973, 1984, 1978, 1978, 1984, 1991, 1991, 1983, 1983, 1983, 1999, 1992,
    //   1992, 1998, 1998, 1998, 2006, 2006, 1999, 2016, 2016, 2005, 2038, 2038,
    //   2006, 2017, 2017, 2042, 2027, 2027, 2031, 2031, 2051, 2044, 2044, 2043,
    //   2070, 2070, 2062, 2055, 2055, 2065, 2056, 2056, 2070, 2080, 2080, 2068,
    //   2078, 2078, 2077, 2077, 2074, 2087, 2087, 2093, 2102, 2102, 2091, 2102,
    //   2102, 2118, 2114, 2114, 2116, 2128, 2128, 2108, 2108, 2095, 2108, 2108,
    //   2102, 2096, 2096, 2094, 2081, 2081, 2074, 2082, 2082, 2088, 2059, 2059,
    //   2058, 2050, 2050, 2027, 2027, 2014, 2009, 2009, 1991, 1981, 1981, 1951,
    //   1949, 1949, 1932, 1918, 1918, 1923, 1893, 1893, 1885, 1885, 1894, 1882,
    //   1882, 1871, 1890, 1890, 1865, 1868, 1868, 1874, 1876, 1876, 1887, 1884,
    //   1884, 1886, 1888, 1888, 1895, 1902, 1902, 1898, 1898, 1898, 1906, 1906,
    //   1911, 1914, 1914, 1918, 1922, 1922, 1918, 1936, 1936, 1950, 1937, 1937,
    //   1944, 1944, 1955, 1947, 1947, 1951, 1984, 1984, 1950, 1972, 1972, 1974,
    //   1958, 1958, 1982, 1971, 1971, 1983, 1974, 1974, 1967, 1986, 1986, 1979,
    //   1979, 1970, 1986, 1986, 1966, 1955, 1955, 1970, 1976, 1976, 1972, 1968,
    //   1968, 1970, 1969, 1969, 1967, 1967, 1998, 1976, 1976, 1981, 1994, 1994,
    //   1982, 1987, 1987, 1987, 1996, 1996, 1983, 1974, 1974, 1991, 1991, 1982,
    //   1984, 1984, 2004, 1982, 1982, 1983, 2009, 2009, 1995, 1991, 1991, 2001,
    //   2000, 2000, 1991, 1999, 1999, 2002, 1988, 1988, 1999, 1999, 1979, 2006,
    //   2006, 2005, 1983, 1983, 1995, 1986, 1986, 1992, 2010, 2010, 1993, 2000,
    //   2000, 1994, 1994, 1990, 2012, 2012, 1989, 1993, 1993, 1993, 1986, 1986,
    //   1999, 1986, 1986, 2002, 1995, 1995, 1995, 1993, 1993, 2000, 2000, 1996,
    //   1997, 1997, 1995, 1998, 1998, 1983, 1997, 1997, 1998, 1990, 1990, 1993,
    //   1996, 1996, 1982, 1995, 1995, 2003, 2003, 2003, 1996, 1996, 1993, 1989,
    //   1989, 2007, 2008, 2008, 2006, 2004, 2004, 1997, 2000, 2000, 2012, 2007,
    //   2007, 2013, 2013, 2010, 2004, 2004, 2010, 2011, 2011, 2011, 2015, 2015,
    //   2015, 2016, 2016, 2011, 2005, 2005, 2014, 2014, 2008, 1998, 1998, 2021,
    //   2009, 2009, 2007, 2018,
    // ]

    // var dataPointsArray = [
    //   -37, -61, 88, 156, 9, -19, -61, -75, -37, -57, 89, 159, 12, -16, -59, -77,
    //   -26, -61, 86, 169, 11, -16, -60, -78,
    // ]

    var dataPointsRaw = `
    -231 -9 130 123 76 -66 -133 -64
-230 -21 132 111 63 -37 -167 -68
-186 -50 127 81 77 -72 -132 -78
-161 -114 98 63 47 -71 -148 -70
-150 -130 56 46 51 -76 -174 -87
-141 -114 78 40 32 -76 -143 -86
-131 -129 61 -7 53 -62 -145 -69
-132 -139 69 -7 65 -77 -159 -54
-113 -106 40 -18 63 -57 -141 -90
-122 -123 48 7 52 -70 -126 -86
-108 -106 47 11 56 -75 -147 -126
-88 -120 55 -36 87 -110 -147 -117
-73 -124 39 -44 90 -112 -146 -113
-74 -97 20 -46 93 -95 -147 -104
-67 -85 -13 -67 100 -88 -154 -128
-75 -100 -14 -74 96 -99 -154 -125
-79 -95 -14 -99 99 -121 -148 -127
-71 -79 -27 -109 97 -129 -149 -115
-66 -77 -25 -109 78 -108 -145 -119
-64 -75 -25 -93 90 -109 -131 -122
-64 -86 -34 -101 94 -116 -138 -126
-59 -103 -36 -102 94 -120 -157 -126
-60 -101 -19 -99 76 -112 -146 -125
-65 -111 -32 -91 72 -97 -145 -139
-54 -122 -41 -75 92 -104 -164 -149
-36 -120 -28 -82 103 -120 -154 -135
-63 -112 -38 -110 109 -120 -140 -135
-75 -108 -34 -103 112 -107 -137 -127
-64 -102 -24 -90 99 -101 -133 -130
-58 -96 -24 -95 98 -106 -134 -134
-64 -109 -33 -106 96 -104 -144 -130
-59 -120 -44 -110 103 -113 -140 -131
-55 -118 -34 -104 88 -117 -138 -129
-53 -119 -31 -101 77 -110 -150 -136
-53 -131 -41 -95 90 -119 -159 -141
-60 -143 -34 -92 86 -120 -158 -146
-63 -142 -18 -93 86 -120 -153 -141
-56 -134 -16 -98 86 -123 -157 -142
-62 -130 -14 -91 76 -117 -155 -145
-63 -128 -15 -84 77 -112 -146 -144
-61 -130 -17 -88 76 -118 -156 -146
-58 -143 -20 -91 74 -122 -165 -145
-64 -144 -20 -91 66 -126 -170 -151
-56 -141 -16 -87 70 -119 -168 -149
-50 -146 -18 -82 73 -117 -166 -153
-42 -151 -17 -84 73 -124 -168 -149
-53 -158 -10 -90 73 -126 -162 -145
-53 -144 -21 -90 73 -120 -159 -143
-45 -141 -14 -89 68 -118 -163 -147
-43 -140 -21 -93 70 -113 -166 -149
-43 -138 -31 -104 76 -117 -175 -150
-36 -147 -38 -106 75 -117 -179 -149
-37 -140 -38 -106 67 -116 -175 -154
-29 -129 -38 -104 70 -112 -171 -150
-24 -130 -40 -97 78 -111 -164 -150
-22 -126 -45 -92 86 -112 -152 -142
-26 -117 -32 -96 86 -109 -146 -139
-22 -105 -38 -92 98 -102 -147 -135
-20 -97 -29 -86 96 -98 -146 -138
-9 -92 -31 -83 107 -94 -149 -135
-12 -89 -35 -79 115 -93 -150 -135
-3 -90 -39 -76 122 -89 -152 -131
-7 -82 -33 -72 124 -87 -144 -133
2 -62 -34 -66 133 -74 -139 -123
1 -60 -35 -64 143 -66 -126 -115
0 -59 -46 -60 150 -58 -116 -109
-9 -51 -44 -65 153 -52 -106 -104
-5 -49 -48 -66 170 -43 -110 -103
-4 -38 -43 -61 170 -47 -101 -103
1 -29 -41 -64 182 -46 -104 -105
-1 -25 -40 -55 189 -42 -108 -98
5 -22 -41 -59 191 -41 -109 -99
-4 -13 -34 -57 191 -38 -107 -99
0 1 -34 -56 198 -28 -112 -92
-1 10 -40 -51 201 -23 -106 -92
-4 3 -47 -49 196 -21 -104 -93
-13 4 -50 -53 193 -21 -101 -96
    `
    const dataPointsArray = dataPointsRaw.split(' ').map(Number)

    var chart = new CanvasJS.Chart('ecgViewerElement', {
      title: {
        text: '',
      },
      // subtitles:[{
      // text: "Patient Name: Patient Name",
      // horizontalAlign: "left",
      // },
      // {
      // text: "Age: X-Years",
      // horizontalAlign: "left",
      // },
      // {
      // text: "",
      // horizontalAlign: "right",
      // verticalAlign: "bottom",
      // },
      // ],
      axisY: {
        stripLines: yAxisStripLinesArray,
        gridThickness: 2,
        gridColor: '#DC74A5',
        lineColor: '#DC74A5',
        tickColor: '#DC74A5',
        labelFontColor: '#DC74A5',
      },
      axisX: {
        stripLines: xAxisStripLinesArray,
        gridThickness: 2,
        gridColor: '#DC74A5',
        lineColor: '#DC74A5',
        tickColor: '#DC74A5',
        labelFontColor: '#DC74A5',
      },
      data: [
        {
          type: 'spline',
          color: 'black',
          dataPoints: dps,
        },
      ],
    })

    addDataPointsAndStripLines()
    chart.render()

    function addDataPointsAndStripLines() {
      //dataPoints
      for (var i = 0; i < dataPointsArray.length; i++) {
        dps.push({ y: dataPointsArray[i] })
      }
      //StripLines
      for (var i = 0; i < 3000; i = i + 100) {
        if (i % 1000 != 0)
          yAxisStripLinesArray.push({
            value: i,
            thickness: 0.7,
            color: '#DC74A5',
          })
      }
      for (var i = 0; i < 1400; i = i + 20) {
        if (i % 200 != 0)
          xAxisStripLinesArray.push({
            value: i,
            thickness: 0.7,
            color: '#DC74A5',
          })
      }
    }
  },
}
</script>

<style lang="scss" scoped>
</style>